var _FM_=function(){"use strict";function t(){var t=document.querySelector(".S__embedd-warn"),e=document.querySelector(".S__embedd-fee");return function(n){if(n&&!n.hasAttribute("data-content")){n.appendChild(t.cloneNode(!0)),n.setAttribute("data-content","");var i=n.querySelector(".S__ph-fee");i&&(i.parentNode.insertBefore(e.cloneNode(!0),i),i.remove())}}}function e(t,e){e.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(n){t.prototype[n]=e.prototype[n]})})}var n=function(){function t(){}return t}();n.airClassConverter={first_cl:"First",econom_cl:"Econom",business_cl:"Business"},n.serviceCodeConverter={TR:"Air ticketing and reservation",TI:"Travel insurance",VA:"Visa assist",CS:"Consular services",HB:"World wide hotel booking",GT:"Incentive group travel",MP:"Honeymoon packages",FP:"Family packages",HP:"Holiday packages",PP:"Pilgrimage packages"};var i=function(){function t(){this._isCicleFinish=!0,this.delayToClose=5e3,setTimeout(function(){t.SBP.classList.add("SBP__r"),t.SB.classList.add("SB__r")},500)}return t.prototype._resetTime=function(){clearTimeout(this.TimerId),this.TimerId=null},t.prototype._resetPane=function(t){window.removeEventListener("resize",this.OnRes),t.style.left=""},t.prototype._onClickBtn=function(t,e,n){var i=this;return this.OnClickBtn=function(){t.removeEventListener("click",i.OnClickBtn),i._resetTime(),Function.isFn(e)&&e(n)},this.OnClickBtn},t.prototype._normCbs=function(t){return Array.isArray(t)?t:[t]},t.prototype._onTransitEnd=function(t,e){var n=this;return this.OnTransitEnd=function(){t.removeEventListener("transitionend",n.OnTransitEnd);for(var i=0,o=n._normCbs(e);i<o.length;i++){var r=o[i];Function.isFn(r)&&r(t)}},this.OnTransitEnd},t.prototype._onRes=function(t){var e=this;return this.OnRes=function(){e._alignPane(t)},this.OnRes},t.prototype._alignPane=function(e){void 0===e&&(e=t.SBP);var n=document.body.offsetWidth,i=e.offsetWidth;n>i?e.style.left=(n-i)/2+"px":e.style.left="0px"},t.prototype._delayedClose=function(t,e,n,i){var o=this;t&&(this.TimerId=setTimeout(function(){return o.closePane(e,n,i)},this.delayToClose))},t.prototype.destroyPane=function(){var e=t.SBP_btn;t.SBP_mes.innerHTML=e.innerHTML=""},t.prototype.showBar=function(e){if(void 0===e&&(e=!0),e){for(var n=t.SB,i=0,o=n.children;i<o.length;i++){o[i].classList.remove("SB_stop")}n.classList.add("SB__show")}},t.prototype.setNotificator=function(e,n,i){var o=e.mes,r=e.btn,s=e.disabled,a=void 0!==s&&s,c=e.autoClose,l=void 0!==c&&c,u=t.SBP,d=t.SBP_btn;t.SBP_mes.innerHTML=o,d.removeEventListener("click",this.OnClickBtn),d.innerHTML=r,d.disabled=a,this._isCicleFinish||this._alignPane(u),a||d.addEventListener("click",this._onClickBtn(d,n,u)),this._delayedClose(l,null,i,u)},t.prototype.hideBar=function(e,n){var i=this;void 0===e&&(e=!0),void 0===n&&(n=null),setTimeout(function(){if(e){var o=t.SB;o.addEventListener("transitionend",i._onTransitEnd(o,[function(t){return Array.from(t.children).forEach(function(t){return t.classList.add("SB_stop")})},n])),o.classList.remove("SB__show")}else Function.isFn(n)&&n()},1e3)},t.prototype.closePane=function(e,n,i){var o=this;void 0===i&&(i=t.SBP),this._resetTime();var r=t.SBP_btn;r.disabled=!0,this._normCbs(e).forEach(function(t){return Function.isFn(t)?t(i):t}),i.addEventListener("transitionend",this._onTransitEnd(i,[function(){return r.removeEventListener("click",o.OnClickBtn)},function(t){return o._resetPane(t)},function(){o._isCicleFinish=!0}].concat(this._normCbs(n)))),i.classList.remove("SBP__open")},t.prototype.openPane=function(e,n,i,o,r){var s=this;void 0===r&&(r=!1);var a=t.SBP;this._normCbs(e).forEach(function(t){return Function.isFn(t)?t(a):t}),this._alignPane(a),window.addEventListener("resize",this._onRes(a)),a.addEventListener("transitionend",this._onTransitEnd(a,this._normCbs(n).concat([function(t){return s._delayedClose(r,i,o,t)}]))),a.classList.add("SBP__open")},t.prototype.config=function(t){var e=this;return void 0===t&&(t=!0),this._isCicleFinish?(this._isCicleFinish=!1,this.showBar(t),function(n,i,o){var r=Function.isFn(n)?n():n;e.hideBar(t,function(){return e.openPane(e.setNotificator.bind(e,r,i,o))})}):function(){}},t}();i.SBP=document.querySelector(".SBP"),i.SB=document.querySelector(".SB"),i.SBP_btn=document.querySelector(".SBP__btn"),i.SBP_mes=document.querySelector(".SBP__message");var o=function(){function t(t){this.Http=t,this.Timeout=5e3}return t.prototype._onOnLine=function(t,e){var n=this;return this.OnLine=function(){n.watch(t,e),window.ononline=function(){return""}},this.OnLine},t.prototype._send=function(t,e,n){var i=this;this.Http.sendReq(e).then(function(){i.col=i.col.filter(function(t){return t!==n}),localStorage.setItem(t,i.col.join(", ")),i._clearAll(t)})},t.prototype._clearAll=function(t){localStorage.getItem(t)||"number"!=typeof this.Timer||(localStorage.removeItem(t),clearInterval(this.Timer),window.ononline=function(){return""},this.col=this.OnLine=this.Timer=null)},t.prototype.watch=function(t,e){var n=this;this.Timer=setInterval(function(){if(navigator.onLine){var i=localStorage.getItem(t);i?(n.col=i.split(", "),n.col.forEach(function(i){var o=e.options.body,r="string"==typeof o?JSON.parse(o):o;r.reqId=i,e.options.body=r,n._send(t,e,i)})):n._clearAll(t)}else clearInterval(n.Timer),n.Timer=null,window.ononline=n._onOnLine(t,e)},this.Timeout)},t}(),r=function(){function t(){}return t.prototype.checkValidity=function(t){return!t.checkValidity||t.checkValidity()},t.prototype.whiteSpaceWatcher=function(t,e){var n=t.split(" ").filter(function(t){return!!t});n.length>1?e.value=n.join(" "):e.value=n.join("")},t.prototype.validateField=function(t){var e=t.value.trim(),n=t.parentNode;e?(n.classList.add("F__dirty"),this.checkValidity(t)?(this.whiteSpaceWatcher(e,t),this.setMessage(t),n.classList.add("F__valid")):(this.setMessage(t),n.classList.add("F__invalid"))):(t.required&&(this.setMessage(t),n.classList.add("F__invalid")),n.classList.remove("F__dirty"),t.value=""),n.classList.remove("F__active")},t.prototype.setMessage=function(t){t.parentNode.querySelector(".F__inform").innerHTML=t.validationMessage||""},t}(),s=function(){function t(){}return t.prototype.isLSSupport=function(){this.LS="localStorage"in window||!1},t.prototype.userDataBuffLS=function(t){var e=this;void 0===t&&(t="data-cache");var n={};return function(i){return i&&i.hasAttribute(t)&&(n[i.id]=i.value),function(){e.LS&&localStorage.setItem(e.U_Flag,JSON.stringify(n))}}},t.prototype.userDataUnBuffLS=function(){var t=localStorage.getItem(this.U_Flag),e=t&&JSON.parse(t);return!(!this.LS||!e)&&function(t){var n=""+t.id;n in e&&t.setAttribute("value",e[n])}},t.prototype.userDataKillBuffLS=function(){this.LS&&localStorage.removeItem(this.U_Flag)},t.prototype.hydratorLS=function(t){if(this.LS){var e=this.H_Flag,n=localStorage.getItem(e);if(n){var i=n.split(", ");i.push(t),localStorage.setItem(e,i.join(", "))}else localStorage.setItem(e,t);return!0}return!1},t}(),a=function(){function e(t,e,n){this.targetSelector=t,this.containerSelector=e,this.memPosition=null,this.ModalContainer=document.querySelector(".Modal__cont"),this.OnCl=this._onCl(n),window.addEventListener("click",this.OnCl),this._createSkypeLink()}return e.setPlugin=function(n,i,o){return void 0===n&&(n=".S__cel"),void 0===i&&(i=".S__mod"),void 0===o&&(o=t()),new e(n,i,o)},e.prototype._onCl=function(t){var e=this;return function(n){try{var i=n.target,o=i.closest(e.targetSelector);if(i.closest(".Modal__close-btn")||i.closest(".Modal__can"))e._deactivate();else if(o)e.memPosition=o.parentNode.querySelector(e.containerSelector),e._addContent(e.memPosition.firstElementChild,t);else if(!o)return}catch(t){}}},e.prototype._addContent=function(t,e){e(t),this.ModalContainer.appendChild(t),this._activate()},e.prototype._activate=function(){document.body.classList.add("Modal__A")},e.prototype._deactivate=function(){document.body.classList.remove("Modal__A"),this._replaceContent()},e.prototype._replaceContent=function(){this.memPosition.appendChild(this.ModalContainer.firstElementChild),this.memPosition=null},e.prototype._createSkypeLink=function(){var t=document.querySelector(".Modal__call-link"),e=document.getElementById("call");e&&e.href&&(t.href=e.href)},e.prototype.unsetPlugin=function(){window.removeEventListener("click",this.OnCl)},e}(),c=function(){function t(t){switch(this.H_Flag="que",this.U_Flag="user",this.Base=window._WFW_,this.snackBar=new i,t){case"form":this.isLSSupport(),this.scheduller=new o(this.Base.httpService),this._setOnAllInputs(),this.OnRes=this._onLayoutChange(Array.from(document.querySelectorAll("[data-layout]")),document.querySelectorAll(".F__layout-block")),this.OnRes(),this.Base._U_EventListSetter("resize",this.OnRes);break;default:this.modalPopIns=a.setPlugin()}}return Object.defineProperty(t.prototype,"LANG",{get:function(){return window.SITE_LANG||"EN"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Default_btn",{get:function(){return document.getElementById("Default_btn").innerHTML},enumerable:!0,configurable:!0}),t.prototype._httpOpts=function(t,e,n){return void 0===n&&(n="POST"),{url:t,options:{method:n,cache:"no-cache",headers:{"Content-type":"application/json; charset=utf-8",Accept:"application/json"},body:e}}},t.prototype._formSerializer=function(t){var e=t.querySelectorAll(".F__form-wrap input:not([type=submit]), .F__form-wrap textarea"),i={},o=this.Base.S7.flipTarget.dataset.code;i.service=n.serviceCodeConverter[o];for(var r=this.userDataBuffLS(),s=0,a=e;s<a.length;s++){var c=a[s];if(r(c),"radio"===c.type||"checkbox"===c.type){if(c.checked){var l=c.id,u=n.airClassConverter[l];i.class=u}}else{if(!c.value.trim())continue;i[c.id]=c.value.trim()}}return[Object.assign({ACTION:"REGISTER",SITE_LANG:this.LANG},i),r()]},t.prototype._delay=function(t){setTimeout(t,1e3)},t.prototype._disableBtn=function(t){t.disabled=!0},t.prototype._enableBtn=function(t){t.disabled=!1},t.prototype._onSubmit=function(t,e,n){var i=this,o=t.onClS,r=t.onClF,s=t.onAfClose;return function(t){t.preventDefault();var a=t.target,c=a.querySelectorAll(".F__invalid"),l=a.action;if(t.isTrusted&&a.checkValidity&&a.checkValidity()&&c.length<=0&&i.Base.S7.isCanSendForm){i.Base.S7.isCanSendForm=!1;var u=i.snackBar.config();i._disableBtn(l);var d=i._formSerializer(a);i.Base.httpService.sendReq(i._httpOpts(i.Base.S7.URIs.order,d[0])).then(function(t){t=JSON.parse(t),i.Base.ReqID=t.reqId,Function.isFn(e)&&e(),d[1](),u({mes:t.info,btn:document.querySelector("#N__register .N__success .btn").innerHTML,autoClose:!0,disabled:!1},o,s)}).catch(function(){Function.isFn(n)&&n(),u(i._forWidgetExtractor({selectorName:"#N__register .N__fail"}),function(){return r(function(){i.Base.S7.isCanSendForm=!0,i._enableBtn(l),i.snackBar.destroyPane()})},[function(){return i._enableBtn(l)},s])}).then(function(){u=null})}}},t.prototype._forWidgetExtractor=function(t,e){var n=this,i=t.selectorName,o=t.mesSel,r=void 0===o?".mes":o,s=t.btnSel,a=void 0===s?".btn":s,c=void 0===e?{}:e,l=c.autoClose,u=void 0===l||l,d=c.disabled,f=void 0!==d&&d;if(!i)throw Error("You Idiot!");return function(){var t=document.querySelector(i);return{mes:t.querySelector(r).innerHTML,btn:t.querySelector(a)?t.querySelector(a).innerHTML:n.Default_btn,autoClose:u,disabled:f}}},t.prototype._setDefDate=function(t){t.type.includes("date")&&(t.parentNode.classList.add("F__dirty"),setTimeout(function(){t.value=(new Date).toISOString().substring(0,10)}),t.min=(new Date).toISOString().substring(0,10))},t.prototype._checkDefaults=function(t){t.value&&t.parentNode.classList.add("F__dirty")},t.prototype._createMesPh=function(t){var e=document.createElement("div");e.className="F__inform",e.innerHTML="",t.parentNode.insertBefore(e,t.nextElementSibling)},t.prototype._setOnAllInputs=function(){var t=this,e=document.querySelectorAll(".F__form-wrap input:not([type=submit]), .F__form-wrap textarea");this.OnFocus=function(t){var e=t.target,n=e.parentNode;n.classList.remove("F__valid"),n.classList.remove("F__invalid"),n.classList.add("F__active")},this.OnBlur=function(e){var n=e.target;t.validateField(n)};for(var n=this.userDataUnBuffLS(),i=0,o=e;i<o.length;i++){var r=o[i];n&&n(r),"checkbox"!==r.type&&"radio"!==r.type&&(this._createMesPh(r),this._setDefDate(r),this._checkDefaults(r),this.Base._U_EventListSetter("focus",this.OnFocus,r),this.Base._U_EventListSetter("blur",this.OnBlur,r))}},t.prototype._onLayoutChange=function(t,e){var n=923,i=document.querySelectorAll("[data-ins-point]"),o=!1;return function(){var r=document.documentElement.offsetWidth;n>r&&!o?(o=!0,t.forEach(function(t){t.hasAttribute("data-layout-up")?e[0].insertBefore(t,i[0]):e[1].appendChild(t)})):r>=n&&o&&(o=!1,t.forEach(function(t){t.hasAttribute("data-layout-up")?e[1].insertBefore(t,i[1]):e[0].appendChild(t)}))}},t.prototype.canceller=function(){var t=this,e=this,n=e.LANG,i=e.Base,o=e.H_Flag,r=e.scheduller,s=e.snackBar,a=function(){i.S7.isCanSendForm=!0,i.ReqID=null,s.destroyPane()},c=function(e,n){return void 0===n&&(n=function(){return s.closePane(null,a)}),s.setNotificator({mes:e,btn:t.Default_btn,autoClose:!0,disabled:!1},n,a)},l={ACTION:"CANCEL",SITE_LANG:n,reqId:i.ReqID};s.setNotificator(this._forWidgetExtractor({selectorName:"#N__cancel .N__inprocess"},{autoClose:!1,disabled:!0})());var u=this._httpOpts(i.S7.URIs.order,l,"DELETE");i.httpService.sendReq(u).then(function(e){return t._delay(function(){return c(e)})}).catch(function(){return t._delay(function(){t.hydratorLS(i.ReqID)?r&&Function.isFn(r.watch)&&r.watch(o,u):null,c(document.querySelector("#N__cancel .N__fail .mes").innerHTML)})}).then(function(){return t.userDataKillBuffLS()})},t.prototype.onCloseForm=function(){window.removeEventListener("resize",this.OnRes);for(var t=0,e=document.forms;t<e.length;t++){e[t].removeEventListener("submit",this.OnSub)}for(var n=0,i=document.querySelectorAll(".F__form-wrap input:not([type=submit]), .F__form-wrap textarea");n<i.length;n++){var o=i[n];o.removeEventListener("focus",this.OnFocus),o.removeEventListener("blur",this.OnBlur)}},t.prototype.setModule=function(t,e,n){this.OnSub=this._onSubmit(t,e,n);for(var i=0,o=document.forms;i<o.length;i++){var r=o[i];this.Base._U_EventListSetter("submit",this.OnSub,r)}},t.prototype.unsetModule=function(){this.modalPopIns?this.modalPopIns.unsetPlugin():this.onCloseForm()},t}();return e(c,[r,s]),c}();
