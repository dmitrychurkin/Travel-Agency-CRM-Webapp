var _FM_=function(){"use strict";function t(){var t=document.querySelector(".S__embedd-warn"),e=document.querySelector(".S__embedd-fee");return function(n){if(n&&!n.hasAttribute("data-content")){n.appendChild(t.cloneNode(!0)),n.setAttribute("data-content","");var o=n.querySelector(".S__ph-fee");o&&(o.parentNode.insertBefore(e.cloneNode(!0),o),o.remove())}}}function e(t,e){e.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(n){t.prototype[n]=e.prototype[n]})})}var n=function(){function t(){this._isCicleFinish=!0,this.delayToClose=5e3,setTimeout(function(){t.SBP.classList.add("SBP__r"),t.SB.classList.add("SB__r")},500)}return t.prototype._resetTime=function(){clearTimeout(this.TimerId),this.TimerId=null},t.prototype._resetPane=function(t){window.removeEventListener("resize",this.OnRes),t.style.left=""},t.prototype._onClickBtn=function(t,e,n){var o=this;return this.OnClickBtn=function(){t.removeEventListener("click",o.OnClickBtn),o._resetTime(),Function.isFn(e)&&e(n)},this.OnClickBtn},t.prototype._normCbs=function(t){return Array.isArray(t)?t:[t]},t.prototype._onTransitEnd=function(t,e){var n=this;return this.OnTransitEnd=function(){t.removeEventListener("transitionend",n.OnTransitEnd);for(var o=0,i=n._normCbs(e);o<i.length;o++){var r=i[o];Function.isFn(r)&&r(t)}},this.OnTransitEnd},t.prototype._onRes=function(t){var e=this;return this.OnRes=function(){e._alignPane(t)},this.OnRes},t.prototype._alignPane=function(e){void 0===e&&(e=t.SBP);var n=document.body.offsetWidth,o=e.offsetWidth;n>o?e.style.left=(n-o)/2+"px":e.style.left="0px"},t.prototype._delayedClose=function(t,e,n,o){var i=this;t&&(this.TimerId=setTimeout(function(){return i.closePane(e,n,o)},this.delayToClose))},t.prototype.destroyPane=function(){var e=t.SBP_btn;t.SBP_mes.innerHTML=e.innerHTML=""},t.prototype.showBar=function(e){if(void 0===e&&(e=!0),e){for(var n=t.SB,o=0,i=n.children;o<i.length;o++){i[o].classList.remove("SB_stop")}n.classList.add("SB__show")}},t.prototype.setNotificator=function(e,n,o){var i=e.mes,r=e.btn,s=e.disabled,a=void 0!==s&&s,c=e.autoClose,u=void 0!==c&&c,l=t.SBP,d=t.SBP_btn;t.SBP_mes.innerHTML=i,d.removeEventListener("click",this.OnClickBtn),d.innerHTML=r,d.disabled=a,this._isCicleFinish||this._alignPane(l),a||d.addEventListener("click",this._onClickBtn(d,n,l)),this._delayedClose(u,null,o,l)},t.prototype.hideBar=function(e,n){var o=this;void 0===e&&(e=!0),void 0===n&&(n=null),setTimeout(function(){if(e){var i=t.SB;i.addEventListener("transitionend",o._onTransitEnd(i,[function(t){return Array.from(t.children).forEach(function(t){return t.classList.add("SB_stop")})},n])),i.classList.remove("SB__show")}else Function.isFn(n)&&n()},1e3)},t.prototype.closePane=function(e,n,o){var i=this;void 0===o&&(o=t.SBP),this._resetTime();var r=t.SBP_btn;r.disabled=!0,this._normCbs(e).forEach(function(t){return Function.isFn(t)?t(o):t}),o.addEventListener("transitionend",this._onTransitEnd(o,[function(){return r.removeEventListener("click",i.OnClickBtn)},function(t){return i._resetPane(t)},function(){i._isCicleFinish=!0}].concat(this._normCbs(n)))),o.classList.remove("SBP__open")},t.prototype.openPane=function(e,n,o,i,r){var s=this;void 0===r&&(r=!1);var a=t.SBP;this._normCbs(e).forEach(function(t){return Function.isFn(t)?t(a):t}),this._alignPane(a),window.addEventListener("resize",this._onRes(a)),a.addEventListener("transitionend",this._onTransitEnd(a,this._normCbs(n).concat([function(t){return s._delayedClose(r,o,i,t)}]))),a.classList.add("SBP__open")},t.prototype.config=function(t){var e=this;return void 0===t&&(t=!0),this._isCicleFinish?(this._isCicleFinish=!1,this.showBar(t),function(n,o,i){var r=Function.isFn(n)?n():n;e.hideBar(t,function(){return e.openPane(e.setNotificator.bind(e,r,o,i))})}):function(){}},t}();n.SBP=document.querySelector(".SBP"),n.SB=document.querySelector(".SB"),n.SBP_btn=document.querySelector(".SBP__btn"),n.SBP_mes=document.querySelector(".SBP__message");var o=function(){function t(t){this.Http=t,this.Timeout=5e3}return t.prototype._onOnLine=function(t,e){var n=this;return this.OnLine=function(){n.watch(t,e),window.ononline=function(){return""}},this.OnLine},t.prototype._send=function(t,e,n){var o=this;this.Http.sendReq(e).then(function(){o.col=o.col.filter(function(t){return t!==n}),localStorage.setItem(t,o.col.join(", ")),o._clearAll(t)})},t.prototype._clearAll=function(t){localStorage.getItem(t)||"number"!=typeof this.Timer||(localStorage.removeItem(t),clearInterval(this.Timer),window.ononline=function(){return""},this.col=this.OnLine=this.Timer=null)},t.prototype.watch=function(t,e){var n=this;this.Timer=setInterval(function(){if(navigator.onLine){var o=localStorage.getItem(t);o?(n.col=o.split(", "),n.col.forEach(function(o){var i=e.options.body,r="string"==typeof i?JSON.parse(i):i;r.reqId=o,e.options.body=r,n._send(t,e,o)})):n._clearAll(t)}else clearInterval(n.Timer),n.Timer=null,window.ononline=n._onOnLine(t,e)},this.Timeout)},t}(),i=function(){function t(){}return t.prototype.checkValidity=function(t){return!t.checkValidity||t.checkValidity()},t.prototype.whiteSpaceWatcher=function(t,e){var n=t.split(" ").filter(function(t){return!!t});n.length>1?e.value=n.join(" "):e.value=n.join("")},t.prototype.validateField=function(t){var e=t.value.trim(),n=t.parentNode;e?(n.classList.add("F__dirty"),this.checkValidity(t)?(this.whiteSpaceWatcher(e,t),this.setMessage(t),n.classList.add("F__valid")):(this.setMessage(t),n.classList.add("F__invalid"))):(t.required&&(this.setMessage(t),n.classList.add("F__invalid")),n.classList.remove("F__dirty"),t.value=""),n.classList.remove("F__active")},t.prototype.setMessage=function(t){t.parentNode.querySelector(".F__inform").innerHTML=t.validationMessage||""},t}(),r=function(){function t(){}return t.prototype.isLSSupport=function(){this.LS="localStorage"in window||!1},t.prototype.userDataBuffLS=function(t){var e=this;void 0===t&&(t="data-cache");var n={};return function(o){return o&&o.hasAttribute(t)&&(n[o.id]=o.value),function(){e.LS&&localStorage.setItem(e.U_Flag,JSON.stringify(n))}}},t.prototype.userDataUnBuffLS=function(){var t=localStorage.getItem(this.U_Flag),e=t&&JSON.parse(t);return!(!this.LS||!e)&&function(t){var n=""+t.id;n in e&&t.setAttribute("value",e[n])}},t.prototype.userDataKillBuffLS=function(){this.LS&&localStorage.removeItem(this.U_Flag)},t.prototype.hydratorLS=function(t){if(this.LS){var e=this.H_Flag,n=localStorage.getItem(e);if(n){var o=n.split(", ");o.push(t),localStorage.setItem(e,o.join(", "))}else localStorage.setItem(e,t);return!0}return!1},t}(),s=function(){function e(t,e,n){this.targetSelector=t,this.containerSelector=e,this.memPosition=null,this.ModalContainer=document.querySelector(".Modal__cont"),this.OnCl=this._onCl(n),window.addEventListener("click",this.OnCl),this._createSkypeLink()}return e.setPlugin=function(n,o,i){return void 0===n&&(n=".S__cel"),void 0===o&&(o=".S__mod"),void 0===i&&(i=t()),new e(n,o,i)},e.prototype._onCl=function(t){var e=this;return function(n){try{var o=n.target,i=o.closest(e.targetSelector);if(o.closest(".Modal__close-btn")||o.closest(".Modal__can"))e._deactivate();else if(i)e.memPosition=i.parentNode.querySelector(e.containerSelector),e._addContent(e.memPosition.firstElementChild,t);else if(!i)return}catch(t){}}},e.prototype._addContent=function(t,e){e(t),this.ModalContainer.appendChild(t),this._activate()},e.prototype._activate=function(){document.body.classList.add("Modal__A")},e.prototype._deactivate=function(){document.body.classList.remove("Modal__A"),this._replaceContent()},e.prototype._replaceContent=function(){this.memPosition.appendChild(this.ModalContainer.firstElementChild),this.memPosition=null},e.prototype._createSkypeLink=function(){var t=document.querySelector(".Modal__call-link"),e=document.getElementById("call");e&&e.href&&(t.href=e.href)},e.prototype.unsetPlugin=function(){window.removeEventListener("click",this.OnCl)},e}(),a=function(){function t(t){switch(this.H_Flag="que",this.U_Flag="user",this.Base=window._WFW_,this.snackBar=new n,t){case"form":this.isLSSupport(),this.scheduller=new o(this.Base.httpService),this._setOnAllInputs(),this.OnRes=this._onLayoutChange(Array.from(document.querySelectorAll("[data-layout]")),document.querySelectorAll(".F__layout-block")),this.OnRes(),this.Base._U_EventListSetter("resize",this.OnRes);break;default:this.modalPopIns=s.setPlugin()}}return Object.defineProperty(t.prototype,"LANG",{get:function(){return window.SITE_LANG||"EN"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Default_btn",{get:function(){return document.getElementById("Default_btn").innerHTML},enumerable:!0,configurable:!0}),t.prototype._httpOpts=function(t,e,n){return void 0===n&&(n="POST"),{url:t,options:{method:n,cache:"no-cache",headers:{"Content-type":"application/json; charset=utf-8",Accept:"application/json"},body:e}}},t.prototype._formSerializer=function(t){for(var e=t.querySelectorAll(".F__form-wrap input:not([type=submit]), .F__form-wrap textarea"),n={},o=this.userDataBuffLS(),i=0,r=e;i<r.length;i++){var s=r[i];if(o(s),"radio"===s.type||"checkbox"===s.type)s.checked&&(n[s.id]=!0);else{if(!s.value.trim())continue;n[s.id]=s.value.trim()}}return[Object.assign({ACTION:"REGISTER",SITE_LANG:this.LANG},n),o()]},t.prototype._delay=function(t){setTimeout(t,1e3)},t.prototype._disableBtn=function(t){t.disabled=!0},t.prototype._enableBtn=function(t){t.disabled=!1},t.prototype._onSubmit=function(t,e,n){var o=this,i=t.onClS,r=t.onClF,s=t.onAfClose;return function(t){t.preventDefault();var a=t.target,c=a.querySelectorAll(".F__invalid"),u=a.action;if(t.isTrusted&&c.length<=0&&o.Base.S7.isCanSendForm){o.Base.S7.isCanSendForm=!1;var l=o.snackBar.config();o._disableBtn(u);var d=o._formSerializer(a);o.Base.httpService.sendReq(o._httpOpts(o.Base.S7.URIs.order,d[0])).then(function(t){t=JSON.parse(t),o.Base.ReqID=t.reqId,Function.isFn(e)&&e(),d[1](),l({mes:t.info,btn:document.querySelector("#N__register .N__success .btn").innerHTML,autoClose:!0,disabled:!1},i,s)}).catch(function(){Function.isFn(n)&&n(),l(o._forWidgetExtractor({selectorName:"#N__register .N__fail"}),function(){return r(function(){o.Base.S7.isCanSendForm=!0,o._enableBtn(u),o.snackBar.destroyPane()})},[function(){return o._enableBtn(u)},s])}).then(function(){l=null})}}},t.prototype._forWidgetExtractor=function(t,e){var n=this,o=t.selectorName,i=t.mesSel,r=void 0===i?".mes":i,s=t.btnSel,a=void 0===s?".btn":s,c=void 0===e?{}:e,u=c.autoClose,l=void 0===u||u,d=c.disabled,f=void 0!==d&&d;if(!o)throw Error("You Idiot!");return function(){var t=document.querySelector(o);return{mes:t.querySelector(r).innerHTML,btn:t.querySelector(a)?t.querySelector(a).innerHTML:n.Default_btn,autoClose:l,disabled:f}}},t.prototype._setDefDate=function(t){t.type.includes("date")&&(t.parentNode.classList.add("F__dirty"),setTimeout(function(){t.value=(new Date).toISOString().substring(0,10)}),t.min=(new Date).toISOString().substring(0,10))},t.prototype._checkDefaults=function(t){t.value&&t.parentNode.classList.add("F__dirty")},t.prototype._createMesPh=function(t){var e=document.createElement("div");e.className="F__inform",e.innerHTML="",t.parentNode.insertBefore(e,t.nextElementSibling)},t.prototype._setOnAllInputs=function(){var t=this,e=document.querySelectorAll(".F__form-wrap input:not([type=submit]), .F__form-wrap textarea");this.OnFocus=function(t){var e=t.target,n=e.parentNode;n.classList.remove("F__valid"),n.classList.remove("F__invalid"),n.classList.add("F__active")},this.OnBlur=function(e){var n=e.target;t.validateField(n)};for(var n=this.userDataUnBuffLS(),o=0,i=e;o<i.length;o++){var r=i[o];n&&n(r),"checkbox"!==r.type&&"radio"!==r.type&&(this._createMesPh(r),this._setDefDate(r),this._checkDefaults(r),this.Base._U_EventListSetter("focus",this.OnFocus,r),this.Base._U_EventListSetter("blur",this.OnBlur,r))}},t.prototype._onLayoutChange=function(t,e){var n=923,o=document.querySelectorAll("[data-ins-point]"),i=!1;return function(){var r=document.documentElement.offsetWidth;n>r&&!i?(i=!0,t.forEach(function(t){t.hasAttribute("data-layout-up")?e[0].insertBefore(t,o[0]):e[1].appendChild(t)})):r>=n&&i&&(i=!1,t.forEach(function(t){t.hasAttribute("data-layout-up")?e[1].insertBefore(t,o[1]):e[0].appendChild(t)}))}},t.prototype.canceller=function(){var t=this,e=this,n=e.LANG,o=e.Base,i=e.H_Flag,r=e.scheduller,s=e.snackBar,a=function(){o.S7.isCanSendForm=!0,o.ReqID=null,s.destroyPane()},c=function(e,n){return void 0===n&&(n=function(){return s.closePane(null,a)}),s.setNotificator({mes:e,btn:t.Default_btn,autoClose:!0,disabled:!1},n,a)},u={ACTION:"CANCEL",SITE_LANG:n,reqId:o.ReqID};s.setNotificator(this._forWidgetExtractor({selectorName:"#N__cancel .N__inprocess"},{autoClose:!1,disabled:!0})());var l=this._httpOpts(o.S7.URIs.order,u,"DELETE");o.httpService.sendReq(l).then(function(e){return t._delay(function(){return c(e)})}).catch(function(){return t._delay(function(){t.hydratorLS(o.ReqID)?r&&Function.isFn(r.watch)&&r.watch(i,l):null,c(document.querySelector("#N__cancel .N__fail .mes").innerHTML)})}).then(function(){return t.userDataKillBuffLS()})},t.prototype.onCloseForm=function(){window.removeEventListener("resize",this.OnRes);for(var t=0,e=document.forms;t<e.length;t++){e[t].removeEventListener("submit",this.OnSub)}for(var n=0,o=document.querySelectorAll(".F__form-wrap input:not([type=submit]), .F__form-wrap textarea");n<o.length;n++){var i=o[n];i.removeEventListener("focus",this.OnFocus),i.removeEventListener("blur",this.OnBlur)}},t.prototype.setModule=function(t,e,n){this.OnSub=this._onSubmit(t,e,n);for(var o=0,i=document.forms;o<i.length;o++){var r=i[o];this.Base._U_EventListSetter("submit",this.OnSub,r)}},t.prototype.unsetModule=function(){this.modalPopIns?this.modalPopIns.unsetPlugin():this.onCloseForm()},t}();return e(a,[i,r]),a}();
